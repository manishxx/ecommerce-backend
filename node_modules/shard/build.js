var fs = require('fs'), path = require('path');

var codeTemplate = fs.readFileSync(path.join(__dirname, 'template-code.js'), {encoding: 'utf-8'});
var indexCode = fs.readFileSync(path.join(__dirname, 'index.js'), {encoding: 'utf-8'});
indexCode = indexCode.replace(/\/\*CODETEMPLATE\*\/[^\n]*;/, '/*CODETEMPLATE*/' + JSON.stringify(codeTemplate) + ';');
fs.writeFileSync(path.join(__dirname, 'index.js'), indexCode);

module.exports = require('./index');
